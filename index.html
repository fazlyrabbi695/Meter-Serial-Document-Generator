<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meter Serial Document Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Meter Serial Document Generator</h1>
            <p>Generate 20 documents automatically with sequential meter serial numbers</p>
        </header>

        <div class="input-section">
            <div class="config-management">
                <h3>Configuration Management</h3>
                <div class="form-group">
                    <label for="meterType">Meter Type (Configuration Key):</label>
                    <input type="text" id="meterType" placeholder="Enter meter type" value="N.M 787(Three Phase Electronic kWh Meter)" onchange="onMeterTypeChange()">
                </div>
                <div class="config-buttons">
                    <button type="button" id="saveConfigBtn" onclick="saveConfiguration()" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                        Save Configuration
                    </button>
                    <button type="button" id="loadConfigBtn" onclick="loadConfiguration()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 10px;">
                        Load Configuration
                    </button>
                    <button type="button" id="deleteConfigBtn" onclick="deleteConfiguration()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                        Delete Configuration
                    </button>
                </div>
                <div class="saved-configs" id="savedConfigsList" style="margin-top: 15px;">
                    <!-- Saved configurations will be displayed here -->
                </div>
            </div>

            <div class="form-group">
                <label for="startingSerial">Starting Meter Serial Number:</label>
                <input type="text" id="startingSerial" placeholder="Enter starting serial number (e.g., MSN001)" maxlength="20">
            </div>
            
            <div class="form-group">
                <label for="documentCount">Number of Documents to Generate:</label>
                <input type="number" id="documentCount" placeholder="Enter document count" min="1" max="100" value="20">
            </div>
            
            <div class="form-group">
                <label for="documentTitle">Document Title:</label>
                <input type="text" id="documentTitle" placeholder="Enter document title" value="Meter Test Report">
            </div>

            <div class="form-group">
                <label for="companyName">Company Name:</label>
                <input type="text" id="companyName" placeholder="Enter company name" value="Northern Trade International">
            </div>

            <div class="form-group">
                <label for="meterSpecification">Meter Specification:</label>
                <textarea id="meterSpecification" placeholder="Enter meter specification" rows="3">3×240/415V  3×10(100)A,50HZ 800imp/kWh
800imp/Kvarh Class 1.0</textarea>
            </div>

            <div class="form-group">
                <label for="modelNo">Model No:</label>
                <input type="text" id="modelNo" placeholder="Enter model number" value="N.M786 Current 10(100)A Class 1 Temperature 27 ＋/－2 Deg ℃">
            </div>

            <div class="form-group">
                <label for="relativeHumidity">Relative Humidity:</label>
                <input type="text" id="relativeHumidity" placeholder="Enter relative humidity" value="＜70％">
            </div>

            <div class="form-group">
                <label for="technicalSpecs">Technical Specifications:</label>
                <input type="text" id="technicalSpecs" placeholder="Enter technical specifications" value="Voltage 240/415V, Current 10-100A, Accuracy Class 1.00 Ref: Standard IEC-62053-21">
            </div>

            <div class="form-group">
                <label>Page Margins (inches):</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div>
                        <label for="marginTop" style="font-size: 14px; margin-bottom: 5px;">Top:</label>
                        <input type="number" id="marginTop" step="0.01" min="0" max="2" value="0.79" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label for="marginBottom" style="font-size: 14px; margin-bottom: 5px;">Bottom:</label>
                        <input type="number" id="marginBottom" step="0.01" min="0" max="2" value="0.79" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label for="marginLeft" style="font-size: 14px; margin-bottom: 5px;">Left:</label>
                        <input type="number" id="marginLeft" step="0.01" min="0" max="2" value="0.79" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label for="marginRight" style="font-size: 14px; margin-bottom: 5px;">Right:</label>
                        <input type="number" id="marginRight" step="0.01" min="0" max="2" value="1.19" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Font Sizes (pt):</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div>
                        <label for="fontSizeCompany" style="font-size: 14px; margin-bottom: 5px;">Company Name:</label>
                        <input type="number" id="fontSizeCompany" step="1" min="8" max="36" value="22" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label for="fontSizeSection" style="font-size: 14px; margin-bottom: 5px;">Section Title:</label>
                        <input type="number" id="fontSizeSection" step="1" min="8" max="36" value="22" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label for="fontSizeBody" style="font-size: 14px; margin-bottom: 5px;">Body Text:</label>
                        <input type="number" id="fontSizeBody" step="1" min="8" max="24" value="12" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label for="fontSizeTable" style="font-size: 14px; margin-bottom: 5px;">Table Text:</label>
                        <input type="number" id="fontSizeTable" step="1" min="8" max="24" value="12" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="additionalTests">Additional Tests (Optional):</label>
                <div id="additionalTestsContainer">
                    <!-- Additional test fields will be added here dynamically -->
                </div>
                <button type="button" id="addTestBtn" onclick="addTestField()" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                    + Add Test
                </button>
            </div>

            <button id="generateBtn" onclick="generateDocuments()">Generate Documents</button>
        </div>

        <div class="progress-section" id="progressSection" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <p id="progressText">Generating documents...</p>
        </div>

        <div class="preview-section" id="previewSection" style="display: none;">
            <h2>Generated Documents Preview</h2>
            <div class="document-list" id="documentList"></div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
                <button id="previewAllBtn" onclick="previewCombinedDocument()" style="background: #007bff; color: white; border: none; padding: 15px 20px; font-size: 16px; font-weight: 600; border-radius: 8px; cursor: pointer; display: none;">
                    Preview All Documents
                </button>
                <button id="downloadAllBtn" onclick="downloadAllDocuments()" style="background: linear-gradient(45deg, #28a745, #20c997); color: white; border: none; padding: 15px 20px; font-size: 16px; font-weight: 600; border-radius: 8px; cursor: pointer; display: none;">
                    Download Combined File
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>